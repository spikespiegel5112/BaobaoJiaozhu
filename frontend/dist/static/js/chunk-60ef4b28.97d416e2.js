(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60ef4b28"],{"559e":function(e,t,a){"use strict";a("bdea")},"5d77":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",[a("CommonQuery",[a("template",{slot:"button1"},[a("el-button",{attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},on:{click:e.handleCreateFan}},[e._v(" 添加粉丝 ")]),a("el-button",{attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:e.handleMultipleDelete}},[e._v(" 批量删除 ")])],1),a("template",{slot:"quicksearch"},[a("div",{staticClass:"common_search_wrapper",on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)}}},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.queryModel.brandName,expression:"queryModel.brandName"}],attrs:{placeholder:"请输入",type:"text"},domProps:{value:e.queryModel.brandName},on:{input:function(t){t.target.composing||e.$set(e.queryModel,"brandName",t.target.value)}}})]),a("a",[a("span",{staticClass:"el-icon-search",on:{click:e.search}})])])])],2),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticClass:"common_table_wrapper",attrs:{data:e.tableList,height:e.tableHeight,border:"","element-loading-text":"Loading",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{fixed:"left",type:"selection",width:"30"}}),a("el-table-column",{attrs:{align:"center",fixed:"",label:"No",type:"index",width:"45"}}),a("el-table-column",{attrs:{align:"center",label:"昵称",prop:"nickName"}}),a("el-table-column",{attrs:{align:"center",label:"E-mail",prop:"email"}}),a("el-table-column",{attrs:{align:"center",label:"电话",prop:"phone"}}),a("el-table-column",{attrs:{align:"center",label:"是否到期",prop:"isExpire"}}),a("el-table-column",{attrs:{align:"center",label:"到期时间",prop:"expireDate"}}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit-outline"},on:{click:function(a){return e.handleUpdateFanInfo(t)}}},[e._v(" 编辑基本信息 ")]),a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(a){return e.handleAddPeriod(t)}}},[e._v(" 录入时长 ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t)}}},[e._v(" 删除 ")])]}}])})],1),a("div",{staticClass:"common_pagination_wrapper"},[a("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.limit,"page-sizes":[10,20,30,50,100],total:e.pagination.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(t){return e.$set(e.pagination,"page",t)},"update:current-page":function(t){return e.$set(e.pagination,"page",t)},"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,top:"5vh"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.handleCloseFansInfoDialog}},[a("el-row",{attrs:{type:"flex",justify:"left"}},[a("el-col",{attrs:{span:12}},[a("el-form",{ref:"formData",staticClass:"dialog_wrapper",attrs:{model:e.formData,rules:e.rules,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"粉丝昵称",prop:"nickName"}},[a("el-input",{model:{value:e.formData.nickName,callback:function(t){e.$set(e.formData,"nickName",t)},expression:"formData.nickName"}})],1),a("el-form-item",{attrs:{label:"E-mail",prop:"email"}},[a("el-input",{model:{value:e.formData.email,callback:function(t){e.$set(e.formData,"email",t)},expression:"formData.email"}})],1),a("el-form-item",{attrs:{label:"电话",prop:"phone"}},[a("el-input",{model:{value:e.formData.phone,callback:function(t){e.$set(e.formData,"phone",t)},expression:"formData.phone"}})],1)],1)],1)],1),a("whiteSpace",{attrs:{size:"xl"}}),a("div",{staticClass:"footer alignright"},[a("el-button",{attrs:{type:"primary",disabled:e.submitingFlag},on:{click:e.handleSaveFan}},[e._v(" 保存 ")]),a("el-button",{on:{click:e.handleCloseFansInfoDialog}},[e._v("取消")])],1)],1),a("el-dialog",{attrs:{title:"时长录入",visible:e.dialogrRecordPaymentVisible,top:"5vh",width:"1200px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogrRecordPaymentVisible=t},close:e.handleCloseRecordPeriod}},[a("el-form",{ref:"formData2",attrs:{model:e.formData2,rules:e.rules2,"label-position":"top","label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"起始日期",prop:"startDate"}},[a("el-date-picker",{attrs:{type:"date","picker-options":e.pickerOptions,"default-value":e.defaultTime,editable:!1},on:{change:e.handleChangeStartDate},model:{value:e.formData2.startDate,callback:function(t){e.$set(e.formData2,"startDate",t)},expression:"formData2.startDate"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"时长",prop:"period"}},[a("el-select",{on:{change:e.calculateDuration},model:{value:e.formData2.period,callback:function(t){e.$set(e.formData2,"period",t)},expression:"formData2.period"}},e._l(e.periodDictionary,(function(e,t){return a("el-option",{key:t,attrs:{label:e.title,value:e.value,disabled:e.disabled}})})),1)],1)],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("ul",{staticClass:"duration"},[a("li",[e._v("粉丝昵称："+e._s(e.formData.nickName))]),a("li",[e._v(" 权益状态: "),"new_fan"===e.expireStatus?a("el-tag",{attrs:{type:"info"}},[e._v(" 新粉丝 ")]):"not_started"===e.expireStatus?a("el-tag",{attrs:{type:"info"}},[e._v(" 未开始 ")]):"in_progress"===e.expireStatus?a("el-tag",{attrs:{type:"success"}},[e._v(" 进行中 ")]):e._e(),"expired"===e.expireStatus?a("el-tag",{attrs:{type:"danger"}},[e._v(" 已到期 ")]):e._e()],1),a("li",[e._v(" 当前权益有效期至: "+e._s(e.$isNotEmpty(e.lastExpireDateString)?e.$moment(e.lastExpireDateString).format("YYYY-MM-DD"):"-")+" ")]),a("li",[e._v(" 添加后有效期至: "+e._s(e.$isNotEmpty(e.formData2.expireDate)?e.$moment(e.formData2.expireDate).format("YYYY-MM-DD"):"-")+" ")])])])],1)],1)],1),a("el-button",{attrs:{type:"primary",disabled:e.submitingFlag},on:{click:e.submitAddPeriod}},[e._v(" 保存 ")]),a("whiteSpace",{attrs:{size:"xl"}}),a("el-form-item",{attrs:{label:"权益记录"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticClass:"common_table_wrapper",attrs:{data:e.periodHistoryTableData,border:"","element-loading-text":"Loading",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",fixed:"",label:"No",type:"index",width:"45"}}),a("el-table-column",{attrs:{align:"center",fixed:"",label:"周期",prop:"period"}}),a("el-table-column",{attrs:{align:"center",fixed:"",label:"开始时间",prop:"createdAt"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$moment(1e3*e.getTheDayBeforeOffsetTimestamp({dateString:t.row.expireDate,offsetDays:t.row.period})).format("YYYY-MM-DD"))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"",label:"结束时间",prop:"createdAt"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$moment(t.row.expireDate).format("YYYY-MM-DD"))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"",label:"进行状态",prop:"createdAt"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.checkProgressStatus(t))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"",label:"录入时间",width:"200",prop:"createdAt"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$moment(t.row.createdAt).format("YYYY-MM-DD hh:mm:ss"))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.checkIsNotStartedRecord(t)?a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(a){return e.handleDeletePeriod(t)}}},[e._v(" 删除此权益 ")]):e._e(),e.checkIsExpiredRecord(t)?a("el-button",{attrs:{size:"mini",icon:"el-icon-delete"},on:{click:function(a){return e.handleDeletePeriod(t)}}},[e._v(" 删除此记录 ")]):e._e()]}}])})],1),a("whiteSpace",{attrs:{size:"xl"}}),a("el-pagination",{attrs:{"current-page":e.pagination2.page,"page-size":e.pagination2.limit,total:e.pagination2.total,background:"",layout:"total, prev, pager, next, jumper"},on:{"update:currentPage":function(t){return e.$set(e.pagination2,"page",t)},"update:current-page":function(t){return e.$set(e.pagination2,"page",t)},"current-change":e.getPeriodHistoryTableData,"size-change":e.handleSizeChange2}})],1)],1),a("div",{staticClass:"footer alignright"},[a("el-button",{on:{click:e.handleCloseRecordPeriod}},[e._v("关闭")])],1)],1)],1)},n=[],r=a("5530"),o=a("1da1"),s=a("ade3"),l=(a("159b"),a("d3b7"),a("4de4"),a("d81d"),a("b0c0"),a("a434"),a("4e82"),a("96cf"),{data:function(){var e;return e={getListByPaginationRequest:"fans/getListByPagination",createOrUpdateRequest:"fans/createOrUpdate",deleteItemsRequest:"fans/deleteItems",addPeriodRequest:"fans/addPeriod",getFansInfoRequest:"fans/getFansInfo",getPeriodHistoryRequest:"fans/getPeriodHistory",deletePeriodRequest:"fans/deletePeriod",periodDictionary:[{title:"90天",name:"90days",value:90},{title:"180天",name:"180days",value:180},{title:"365天",name:"365days",value:365}],dialogFormVisible:!1,dialogrRecordPaymentVisible:!1,tableList:[],total:null,listLoading:!0,availabilityFlag:!1,queryModel:{sort:"desc",brandName:""},pagination:{page:1,limit:30},sortOptions:[{label:"ID Ascending",key:"+id"},{label:"ID Descending",key:"-id"}],statusOptions:["published","draft","deleted"],showReviewer:!1,currentVotingFormdata:[]},Object(s["a"])(e,"dialogFormVisible",!1),Object(s["a"])(e,"dialogStatus",""),Object(s["a"])(e,"textMap",{update:"Edit",create:"Create"}),Object(s["a"])(e,"dialogPvVisible",!1),Object(s["a"])(e,"submitingFlag",!1),Object(s["a"])(e,"formData",{nickName:"",email:"",phone:""}),Object(s["a"])(e,"rules",{nickName:[{required:!0,message:"此项为必填项",trigger:"change"}],email:[{required:!1,message:"此项为必填项",trigger:"change"}],phone:[{required:!1,message:"此项为必填项",trigger:"change"}]}),Object(s["a"])(e,"formData2",{startDate:"",period:"",expireDate:""}),Object(s["a"])(e,"rules2",{startDate:[{required:!0,message:"此项为必填项",trigger:"change"}],period:[{required:!0,message:"此项为必填项",trigger:"change"}]}),Object(s["a"])(e,"pagination2",{limit:5,page:1,total:0}),Object(s["a"])(e,"periodHistoryData",[]),Object(s["a"])(e,"periodHistoryTableData",[]),Object(s["a"])(e,"currentPickerData",null),Object(s["a"])(e,"storedExpireDate",null),Object(s["a"])(e,"defaultTime",null),Object(s["a"])(e,"lastExpireDateString",null),Object(s["a"])(e,"expireStatus",null),e},computed:{tableHeight:function(){return this.$store.state.app.tableHeight},dictionaryList:function(){return this.$store.state.app.dictionary.crawlerAddress},dialogHeight:function(){return{height:"60vh"}},period:function(){return this.formData2.startDate},pickerOptions:function(){var e=this,t=this;return{shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"到期日后一天",onClick:function(e){if(t.$isNotEmpty(t.lastExpireDateString)){var a=t.$moment(t.lastExpireDateString).unix()+86400;e.$emit("pick",new Date(1e3*a))}}}],disabledDate:function(t){var a=t.getTime()/1e3;return e.checkDateAvailable(a)}}}},watch:{effectiveDuration:function(e){console.log(e),null===e&&(e=[]),this.formData.startDate=this.$moment(e[0]).format("YYYY-MM-DD"),this.formData.endDate=this.$moment(e[1]).format("YYYY-MM-DD")},currentAdvertisementTabIndex:function(e){console.log(e)}},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getTableData();case 1:case"end":return t.stop()}}),t)})))()},methods:{getTableData:function(){var e=this;this.listLoading=!0,this.queryModel=Object.assign(this.queryModel,this.pagination),this.$http.get(this.getListByPaginationRequest,{params:this.queryModel}).then((function(t){console.log("getListByPaginationRequest",t),e.tableList=t.data,e.pagination.total=t.pagination.total,e.listLoading=!1})).catch((function(e){console.log(e)}))},checkDateAvailable:function(e){var t=this,a=!1;return this.periodHistoryTableData.forEach((function(i){var n=24*i.period*3600,r=t.$moment(i.expireDate).unix(),o=r-n;o<e+86400&&r>e&&(a=!0)})),a},handleFilter:function(){this.pagination.page=1,this.getTableData()},handleSizeChange:function(e){this.pagination.limit=e,this.getTableData()},handleCurrentChange:function(e){this.pagination.page=e,this.getTableData()},handleSizeChange2:function(e){this.pagination2.limit=e,this.getPeriodHistory()},handleCurrentChange2:function(e){this.pagination2.page=e,this.getPeriodHistory()},createData:function(){this.formData.id="",this.updateData()},handleSaveFan:function(){var e=this;this.$refs.formData.validate().then((function(t){e.submitingFlag=!0,console.log(e.formData),e.$http.post(e.createOrUpdateRequest,e.formData).then((function(t){console.log(t),e.submitingFlag=!1,e.$message.success("提交成功"),e.dialogFormVisible=!1,e.getTableData()})).catch((function(t){console.log(t),e.submitingFlag=!1}))})).catch((function(e){console.log(e)}))},handleUpdateFanInfo:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.dialogFormVisible=!0,a.next=3,t.$nextTick();case 3:console.log(e),t.formData={id:e.row.id,email:e.row.email,phone:e.row.phone,nickName:e.row.nickName},console.log(t.formData),t.dialogStatus="update",t.$refs.formData.clearValidate();case 8:case"end":return a.stop()}}),a)})))()},handleAddPeriod:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$nextTick();case 2:return t.dialogrRecordPaymentVisible=!0,t.storedExpireDate=e.row.expireDate,t.formData.nickName=e.row.nickName,t.formData2.id=e.row.id,t.getTableData(),a.next=9,t.getPeriodHistory();case 9:t.defaultTime=t.getDefaultTime();case 10:case"end":return a.stop()}}),a)})))()},submitAddPeriod:function(){var e=this;this.$refs.formData2.validate().then((function(t){e.$http.post(e.addPeriodRequest,e.formData2).then(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(a),e.$message.success("提交成功"),t.next=4,e.getPeriodHistory();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}))},getFansInfo:function(e){var t=this;return new Promise((function(a,i){t.$http.get(t.getFansInfoRequest,{params:{id:e.row.id}}).then((function(e){console.log("getFansInfo++++++",e),t.formData=e.result,a()})).catch((function(e){console.log(e),i(e)}))}))},getPeriodHistory:function(){var e=this;return new Promise((function(t,a){e.$http.get(e.getPeriodHistoryRequest,{params:{limit:e.pagination2.limit,page:e.pagination2.page,fanId:e.formData2.id}}).then((function(a){console.log("getPeriodHistory++++",a),e.periodHistoryData=a.data,e.getPeriodHistoryTableData(1),e.defaultTime=e.getDefaultTime(),e.pagination2.total=a.total,e.getLastExpireDateString(),t()})).catch((function(e){console.log(e),a()}))}))},getPeriodHistoryTableData:function(e){e=e||this.pagination2.page;var t=this.pagination2.limit;e-=1,this.periodHistoryTableData=this.periodHistoryData.filter((function(a,i){return i>=e*t&&i<(e+1)*t}))},getLastExpireDateString:function(){this.lastExpireDateString=this.periodHistoryData[0]?this.periodHistoryData[0].expireDate:"",this.expireStatus=this.checkSchedule()},handleSelectionChange:function(e){this.multipleSelection=e,console.log(e)},handleMultipleDelete:function(){var e=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){console.log("this.multipleSelection+++++",e.multipleSelection),e.deleteRecord(e.multipleSelection.map((function(e){return{id:e.id}})))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},handleDelete:function(e){var t=this;console.log(e),this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteRecord({id:e.row.id})})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},deleteRecord:function(e){var t=this;this.$http.delete(this.deleteItemsRequest,{data:e}).then((function(e){console.log(e),t.$message.success("删除成功"),t.getTableData()})).catch((function(e){console.log(e)}))},expand:function(){this.expandQuery=!this.expandQuery},search:function(){this.getTableData()},reset:function(){this.queryModel.available=!0},focusSortList:function(e,t){var a=this;this.loading=!0,this.$http.get(this.queryRewardProductByNameRequest,{params:{name:this.chosenReward}}).then((function(e){console.log(e),a.loading=!1;var i=[];0!==e.data.length&&(e.data.forEach((function(e,t){i.push(Object.assign(e,{value:e.name}))})),console.log(111,i),t(i))}))},handleCreateFan:function(){this.dialogFormVisible=!0,this.dialogStatus="create"},handleAddOption:function(){this.formData.optionList.push({votingId:this.formData.id,title:"",description:""})},handleDeleteOption:function(e,t){this.formData.optionList.splice(t,1)},handleChangeStartDate:function(e){this.storedExpireDate=e,this.formData2.period="",this.calculateDuration(),this.filterPeriodDictionary()},filterPeriodDictionary:function(){var e=this;this.periodDictionary=this.periodDictionary.map((function(t){return Object(r["a"])(Object(r["a"])({},t),{},{disabled:!!e.$isEmpty(e.formData2.startDate)||!e.checkAvailableDuration(t.value)})}))},calculateDuration:function(){this.storedExpireDate&&this.formData2.period&&(this.formData2.expireDate=this.$moment(this.storedExpireDate).add(this.formData2.period,"days").format("YYYY-MM-DD"))},checkAvailableDuration:function(e){var t=this,a=!1,i=this.periodHistoryData.sort((function(e,a){var i=t.$moment(e.expireDate).unix(),n=t.$moment(a.expireDate).unix();return i<n?-1:i>n?1:0})).map((function(e){return{startDateTimestamp:t.$moment(e.expireDate).unix()-24*e.period*3600,endDateTimestamp:t.$moment(e.expireDate).unix()}}));if(0===this.periodHistoryData.length)a=0===this.periodHistoryData.length;else for(var n=0;n<i.length;n++){var r=i[n],o=e||this.formData2.period;o=this.$isNotEmpty(o)?o:this.periodDictionary[0].value;var s=24*o*3600,l=this.$moment(this.storedExpireDate).unix(),c=l+s,u=n>0?i[n-1].endDateTimestamp:null,d=i[0].startDateTimestamp,p=i[i.length-1].endDateTimestamp;if(l<d&&c<d){a=!0;break}if(l>d&&l<p&&l>u&&c<r.startDateTimestamp){a=!0;break}if(l>p){a=!0;break}}return a},getTheDayAfterOffsetTimestamp:function(e){var t=24*e.offsetDays*3600;return this.$moment(e.dateString).unix()+t},getTheDayBeforeOffsetTimestamp:function(e){var t=24*e.offsetDays*3600;return this.$moment(e.dateString).unix()-t},checkSchedule:function(){var e="",t=this.getTheDayAfterOffsetTimestamp({dateString:this.lastExpireDateString,offsetDays:this.formData2.period}),a=this.$moment().unix();return 0===this.periodHistoryData.length?e="new_fan":t-a<0?e="expired":this.checkIfOnProgress()?e="in_progress":this.checkIfOnProgress()||(e="not_started"),e},checkIfOnProgress:function(){var e=this,t=!1;return this.periodHistoryData.forEach((function(a){var i=e.getTheDayBeforeOffsetTimestamp({dateString:a.expireDate,offsetDays:a.period}),n=e.$moment(a.expireDate).unix(),r=e.$moment().unix();r<=n&&r>=i&&(t=!0)})),t},getDefaultTime:function(){var e=this.$moment();return"not_expired"===this.checkSchedule()?this.$moment(this.lastExpireDateString):e},handleCloseRecordPeriod:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.formData2.resetFields(),e.formData2.expireDate=null,e.periodHistoryData=[],e.pagination2.page=1,e.dialogrRecordPaymentVisible=!1;case 5:case"end":return t.stop()}}),t)})))()},handleCloseFansInfoDialog:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.formData.resetFields(),e.dialogFormVisible=!1;case 2:case"end":return t.stop()}}),t)})))()},handleDeletePeriod:function(e){var t=this;this.$alert("确认删除此条权益?","警告",{type:"warning",callback:function(){var a=Object(o["a"])(regeneratorRuntime.mark((function a(i){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.deletePeriod(i,e);case 1:case"end":return a.stop()}}),a)})));function i(e){return a.apply(this,arguments)}return i}()})},deletePeriod:function(e,t){var a=this;this.$http.delete(this.deletePeriodRequest,{data:{id:t.row.id}}).then(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a.$message({type:"success",message:"权益删除成功"}),e.next=3,a.getPeriodHistory();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}))},checkIsNotStartedRecord:function(e){var t=this.$moment().unix(),a=this.getTheDayBeforeOffsetTimestamp({dateString:e.row.expireDate,offsetDays:e.row.period});return a>=t},checkIsExpiredRecord:function(e){var t=this.$moment().unix(),a=this.$moment(e.row.expireDate).unix();return a<t},checkProgressStatus:function(e){return this.checkIsNotStartedRecord(e)?"未开始":this.checkIsExpiredRecord(e)?"已结束":"进行中"}}}),c=l,u=(a("559e"),a("2877")),d=Object(u["a"])(c,i,n,!1,null,"11611500",null);t["default"]=d.exports},bdea:function(e,t,a){}}]);
//# sourceMappingURL=chunk-60ef4b28.97d416e2.js.map