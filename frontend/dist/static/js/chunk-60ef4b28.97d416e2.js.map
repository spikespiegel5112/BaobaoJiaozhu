{"version":3,"sources":["webpack:///./src/views/Fans/FansManagement.vue?c973","webpack:///./src/views/Fans/FansManagement.vue?e84a","webpack:///src/views/Fans/FansManagement.vue","webpack:///./src/views/Fans/FansManagement.vue?c4d5","webpack:///./src/views/Fans/FansManagement.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","slot","attrs","on","handleCreateFan","_v","handleMultipleDelete","staticClass","$event","type","indexOf","_k","keyCode","key","search","apply","arguments","directives","name","rawName","value","queryModel","expression","domProps","target","composing","$set","modifiers","tableList","tableHeight","handleSelectionChange","scopedSlots","_u","fn","scope","handleUpdateFanInfo","handleAddPeriod","handleDelete","pagination","page","limit","total","handleCurrentChange","handleSizeChange","textMap","dialogStatus","dialogFormVisible","handleCloseFansInfoDialog","ref","formData","rules","model","callback","$$v","submitingFlag","handleSaveFan","dialogrRecordPaymentVisible","handleCloseRecordPeriod","formData2","rules2","pickerOptions","defaultTime","handleChangeStartDate","calculateDuration","_l","item","index","title","disabled","_s","nickName","expireStatus","_e","$isNotEmpty","lastExpireDateString","$moment","format","expireDate","submitAddPeriod","periodHistoryTableData","getTheDayBeforeOffsetTimestamp","dateString","row","offsetDays","period","checkProgressStatus","createdAt","checkIsNotStartedRecord","handleDeletePeriod","checkIsExpiredRecord","pagination2","getPeriodHistoryTableData","handleSizeChange2","staticRenderFns","data","getListByPaginationRequest","createOrUpdateRequest","deleteItemsRequest","addPeriodRequest","getFansInfoRequest","getPeriodHistoryRequest","deletePeriodRequest","periodDictionary","listLoading","availabilityFlag","sort","brandName","sortOptions","statusOptions","showReviewer","currentVotingFormdata","computed","$store","state","app","dictionaryList","dictionary","crawlerAddress","dialogHeight","height","startDate","shortcuts","disabledDate","watch","effectiveDuration","console","log","endDate","currentAdvertisementTabIndex","methods","getTableData","Object","assign","$http","checkDateAvailable","forEach","result","handleFilter","val","getPeriodHistory","handleCurrentChange2","createData","id","updateData","$refs","validate","then","getFansInfo","Promise","periodHistoryData","filter","getLastExpireDateString","checkSchedule","multipleSelection","$confirm","confirmButtonText","cancelButtonText","deleteRecord","expand","expandQuery","reset","available","focusSortList","loading","handleAddOption","optionList","push","votingId","description","handleDeleteOption","splice","storedExpireDate","dateObj","filterPeriodDictionary","map","checkAvailableDuration","length","chosenPeriod","getTheDayAfterOffsetTimestamp","options","unix","offsetDaysTimestamp","checkIfOnProgress","getDefaultTime","$alert","deletePeriod","theDayBeforeOffsetTimestamp","todayTimestamp","expireDateTimestamp","component"],"mappings":"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","file":"static/js/chunk-60ef4b28.97d416e2.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FansManagement.vue?vue&type=style&index=0&id=11611500&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-row',[_c('CommonQuery',[_c('template',{slot:\"button1\"},[_c('el-button',{attrs:{\"icon\":\"el-icon-plus\",\"size\":\"mini\",\"type\":\"primary\"},on:{\"click\":_vm.handleCreateFan}},[_vm._v(\" 添加粉丝 \")]),_c('el-button',{attrs:{\"icon\":\"el-icon-delete\",\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":_vm.handleMultipleDelete}},[_vm._v(\" 批量删除 \")])],1),_c('template',{slot:\"quicksearch\"},[_c('div',{staticClass:\"common_search_wrapper\",on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.search.apply(null, arguments)}}},[_c('label',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.queryModel.brandName),expression:\"queryModel.brandName\"}],attrs:{\"placeholder\":\"请输入\",\"type\":\"text\"},domProps:{\"value\":(_vm.queryModel.brandName)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.queryModel, \"brandName\", $event.target.value)}}})]),_c('a',[_c('span',{staticClass:\"el-icon-search\",on:{\"click\":_vm.search}})])])])],2),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading.body\",value:(_vm.listLoading),expression:\"listLoading\",modifiers:{\"body\":true}}],staticClass:\"common_table_wrapper\",attrs:{\"data\":_vm.tableList,\"height\":_vm.tableHeight,\"border\":\"\",\"element-loading-text\":\"Loading\",\"fit\":\"\",\"highlight-current-row\":\"\"},on:{\"selection-change\":_vm.handleSelectionChange}},[_c('el-table-column',{attrs:{\"fixed\":\"left\",\"type\":\"selection\",\"width\":\"30\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"fixed\":\"\",\"label\":\"No\",\"type\":\"index\",\"width\":\"45\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"昵称\",\"prop\":\"nickName\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"E-mail\",\"prop\":\"email\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"电话\",\"prop\":\"phone\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"是否到期\",\"prop\":\"isExpire\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"到期时间\",\"prop\":\"expireDate\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"fixed\":\"right\",\"label\":\"操作\",\"width\":\"350\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"primary\",\"icon\":\"el-icon-edit-outline\"},on:{\"click\":function($event){return _vm.handleUpdateFanInfo(scope)}}},[_vm._v(\" 编辑基本信息 \")]),_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"primary\",\"icon\":\"el-icon-edit\"},on:{\"click\":function($event){return _vm.handleAddPeriod(scope)}}},[_vm._v(\" 录入时长 \")]),_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.handleDelete(scope)}}},[_vm._v(\" 删除 \")])]}}])})],1),_c('div',{staticClass:\"common_pagination_wrapper\"},[_c('el-pagination',{attrs:{\"current-page\":_vm.pagination.page,\"page-size\":_vm.pagination.limit,\"page-sizes\":[10, 20, 30, 50, 100],\"total\":_vm.pagination.total,\"background\":\"\",\"layout\":\"total, sizes, prev, pager, next, jumper\"},on:{\"update:currentPage\":function($event){return _vm.$set(_vm.pagination, \"page\", $event)},\"update:current-page\":function($event){return _vm.$set(_vm.pagination, \"page\", $event)},\"current-change\":_vm.handleCurrentChange,\"size-change\":_vm.handleSizeChange}})],1),_c('el-dialog',{attrs:{\"title\":_vm.textMap[_vm.dialogStatus],\"visible\":_vm.dialogFormVisible,\"top\":\"5vh\"},on:{\"update:visible\":function($event){_vm.dialogFormVisible=$event},\"close\":_vm.handleCloseFansInfoDialog}},[_c('el-row',{attrs:{\"type\":\"flex\",\"justify\":\"left\"}},[_c('el-col',{attrs:{\"span\":12}},[_c('el-form',{ref:\"formData\",staticClass:\"dialog_wrapper\",attrs:{\"model\":_vm.formData,\"rules\":_vm.rules,\"label-position\":\"right\",\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"粉丝昵称\",\"prop\":\"nickName\"}},[_c('el-input',{model:{value:(_vm.formData.nickName),callback:function ($$v) {_vm.$set(_vm.formData, \"nickName\", $$v)},expression:\"formData.nickName\"}})],1),_c('el-form-item',{attrs:{\"label\":\"E-mail\",\"prop\":\"email\"}},[_c('el-input',{model:{value:(_vm.formData.email),callback:function ($$v) {_vm.$set(_vm.formData, \"email\", $$v)},expression:\"formData.email\"}})],1),_c('el-form-item',{attrs:{\"label\":\"电话\",\"prop\":\"phone\"}},[_c('el-input',{model:{value:(_vm.formData.phone),callback:function ($$v) {_vm.$set(_vm.formData, \"phone\", $$v)},expression:\"formData.phone\"}})],1)],1)],1)],1),_c('whiteSpace',{attrs:{\"size\":\"xl\"}}),_c('div',{staticClass:\"footer alignright\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"disabled\":_vm.submitingFlag},on:{\"click\":_vm.handleSaveFan}},[_vm._v(\" 保存 \")]),_c('el-button',{on:{\"click\":_vm.handleCloseFansInfoDialog}},[_vm._v(\"取消\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"时长录入\",\"visible\":_vm.dialogrRecordPaymentVisible,\"top\":\"5vh\",\"width\":\"1200px\",\"close-on-click-modal\":false},on:{\"update:visible\":function($event){_vm.dialogrRecordPaymentVisible=$event},\"close\":_vm.handleCloseRecordPeriod}},[_c('el-form',{ref:\"formData2\",attrs:{\"model\":_vm.formData2,\"rules\":_vm.rules2,\"label-position\":\"top\",\"label-width\":\"80px\"}},[_c('el-row',[_c('el-col',{attrs:{\"span\":12}},[_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('el-form-item',{attrs:{\"label\":\"起始日期\",\"prop\":\"startDate\"}},[_c('el-date-picker',{attrs:{\"type\":\"date\",\"picker-options\":_vm.pickerOptions,\"default-value\":_vm.defaultTime,\"editable\":false},on:{\"change\":_vm.handleChangeStartDate},model:{value:(_vm.formData2.startDate),callback:function ($$v) {_vm.$set(_vm.formData2, \"startDate\", $$v)},expression:\"formData2.startDate\"}})],1)],1),_c('el-col',{attrs:{\"span\":24}},[_c('el-form-item',{attrs:{\"label\":\"时长\",\"prop\":\"period\"}},[_c('el-select',{on:{\"change\":_vm.calculateDuration},model:{value:(_vm.formData2.period),callback:function ($$v) {_vm.$set(_vm.formData2, \"period\", $$v)},expression:\"formData2.period\"}},_vm._l((_vm.periodDictionary),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.title,\"value\":item.value,\"disabled\":item.disabled}})}),1)],1)],1)],1)],1),_c('el-col',{attrs:{\"span\":12}},[_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('ul',{staticClass:\"duration\"},[_c('li',[_vm._v(\"粉丝昵称：\"+_vm._s(_vm.formData.nickName))]),_c('li',[_vm._v(\" 权益状态: \"),(_vm.expireStatus === 'new_fan')?_c('el-tag',{attrs:{\"type\":\"info\"}},[_vm._v(\" 新粉丝 \")]):(_vm.expireStatus === 'not_started')?_c('el-tag',{attrs:{\"type\":\"info\"}},[_vm._v(\" 未开始 \")]):(_vm.expireStatus === 'in_progress')?_c('el-tag',{attrs:{\"type\":\"success\"}},[_vm._v(\" 进行中 \")]):_vm._e(),(_vm.expireStatus === 'expired')?_c('el-tag',{attrs:{\"type\":\"danger\"}},[_vm._v(\" 已到期 \")]):_vm._e()],1),_c('li',[_vm._v(\" 当前权益有效期至: \"+_vm._s(_vm.$isNotEmpty(_vm.lastExpireDateString) ? _vm.$moment(_vm.lastExpireDateString).format('YYYY-MM-DD') : '-')+\" \")]),_c('li',[_vm._v(\" 添加后有效期至: \"+_vm._s(_vm.$isNotEmpty(_vm.formData2.expireDate) ? _vm.$moment(_vm.formData2.expireDate).format('YYYY-MM-DD') : '-')+\" \")])])])],1)],1)],1),_c('el-button',{attrs:{\"type\":\"primary\",\"disabled\":_vm.submitingFlag},on:{\"click\":_vm.submitAddPeriod}},[_vm._v(\" 保存 \")]),_c('whiteSpace',{attrs:{\"size\":\"xl\"}}),_c('el-form-item',{attrs:{\"label\":\"权益记录\"}},[_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading.body\",value:(_vm.listLoading),expression:\"listLoading\",modifiers:{\"body\":true}}],staticClass:\"common_table_wrapper\",attrs:{\"data\":_vm.periodHistoryTableData,\"border\":\"\",\"element-loading-text\":\"Loading\",\"fit\":\"\",\"highlight-current-row\":\"\"}},[_c('el-table-column',{attrs:{\"align\":\"center\",\"fixed\":\"\",\"label\":\"No\",\"type\":\"index\",\"width\":\"45\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"fixed\":\"\",\"label\":\"周期\",\"prop\":\"period\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"fixed\":\"\",\"label\":\"开始时间\",\"prop\":\"createdAt\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(_vm.$moment( _vm.getTheDayBeforeOffsetTimestamp({ dateString: scope.row.expireDate, offsetDays: scope.row.period }) * 1000 ).format('YYYY-MM-DD'))+\" \")]}}])}),_c('el-table-column',{attrs:{\"align\":\"center\",\"fixed\":\"\",\"label\":\"结束时间\",\"prop\":\"createdAt\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(_vm.$moment(scope.row.expireDate).format('YYYY-MM-DD'))+\" \")]}}])}),_c('el-table-column',{attrs:{\"align\":\"center\",\"fixed\":\"\",\"label\":\"进行状态\",\"prop\":\"createdAt\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(_vm.checkProgressStatus(scope))+\" \")]}}])}),_c('el-table-column',{attrs:{\"align\":\"center\",\"fixed\":\"\",\"label\":\"录入时间\",\"width\":\"200\",\"prop\":\"createdAt\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(_vm.$moment(scope.row.createdAt).format('YYYY-MM-DD hh:mm:ss'))+\" \")]}}])}),_c('el-table-column',{attrs:{\"align\":\"center\",\"fixed\":\"\",\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(_vm.checkIsNotStartedRecord(scope))?_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"mini\",\"icon\":\"el-icon-delete\"},on:{\"click\":function($event){return _vm.handleDeletePeriod(scope)}}},[_vm._v(\" 删除此权益 \")]):_vm._e(),(_vm.checkIsExpiredRecord(scope))?_c('el-button',{attrs:{\"size\":\"mini\",\"icon\":\"el-icon-delete\"},on:{\"click\":function($event){return _vm.handleDeletePeriod(scope)}}},[_vm._v(\" 删除此记录 \")]):_vm._e()]}}])})],1),_c('whiteSpace',{attrs:{\"size\":\"xl\"}}),_c('el-pagination',{attrs:{\"current-page\":_vm.pagination2.page,\"page-size\":_vm.pagination2.limit,\"total\":_vm.pagination2.total,\"background\":\"\",\"layout\":\"total, prev, pager, next, jumper\"},on:{\"update:currentPage\":function($event){return _vm.$set(_vm.pagination2, \"page\", $event)},\"update:current-page\":function($event){return _vm.$set(_vm.pagination2, \"page\", $event)},\"current-change\":_vm.getPeriodHistoryTableData,\"size-change\":_vm.handleSizeChange2}})],1)],1),_c('div',{staticClass:\"footer alignright\"},[_c('el-button',{on:{\"click\":_vm.handleCloseRecordPeriod}},[_vm._v(\"关闭\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <el-row>\r\n    <CommonQuery>\r\n      <template slot=\"button1\">\r\n        <el-button\r\n          @click=\"handleCreateFan\"\r\n          icon=\"el-icon-plus\"\r\n          size=\"mini\"\r\n          type=\"primary\"\r\n        >\r\n          添加粉丝\r\n        </el-button>\r\n        <el-button\r\n          @click=\"handleMultipleDelete\"\r\n          icon=\"el-icon-delete\"\r\n          size=\"mini\"\r\n          type=\"danger\"\r\n        >\r\n          批量删除\r\n        </el-button>\r\n      </template>\r\n      <template slot=\"quicksearch\">\r\n        <div @keyup.enter=\"search\" class=\"common_search_wrapper\">\r\n          <label>\r\n            <input\r\n              placeholder=\"请输入\"\r\n              type=\"text\"\r\n              v-model=\"queryModel.brandName\"\r\n            />\r\n          </label>\r\n          <a>\r\n            <span @click=\"search\" class=\"el-icon-search\"></span>\r\n          </a>\r\n        </div>\r\n      </template>\r\n    </CommonQuery>\r\n    <el-table\r\n      class=\"common_table_wrapper\"\r\n      :data=\"tableList\"\r\n      :height=\"tableHeight\"\r\n      @selection-change=\"handleSelectionChange\"\r\n      border\r\n      element-loading-text=\"Loading\"\r\n      fit\r\n      highlight-current-row\r\n      v-loading.body=\"listLoading\"\r\n    >\r\n      <el-table-column\r\n        fixed=\"left\"\r\n        type=\"selection\"\r\n        width=\"30\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        align=\"center\"\r\n        fixed\r\n        label=\"No\"\r\n        type=\"index\"\r\n        width=\"45\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        align=\"center\"\r\n        label=\"昵称\"\r\n        prop=\"nickName\"\r\n      ></el-table-column>\r\n      <el-table-column align=\"center\" label=\"E-mail\" prop=\"email\">\r\n      </el-table-column>\r\n      <el-table-column align=\"center\" label=\"电话\" prop=\"phone\">\r\n      </el-table-column>\r\n      <el-table-column align=\"center\" label=\"是否到期\" prop=\"isExpire\">\r\n      </el-table-column>\r\n      <el-table-column align=\"center\" label=\"到期时间\" prop=\"expireDate\">\r\n      </el-table-column>\r\n      <el-table-column align=\"center\" fixed=\"right\" label=\"操作\" width=\"350\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button\r\n            @click=\"handleUpdateFanInfo(scope)\"\r\n            size=\"mini\"\r\n            type=\"primary\"\r\n            icon=\"el-icon-edit-outline\"\r\n          >\r\n            编辑基本信息\r\n          </el-button>\r\n          <el-button\r\n            @click=\"handleAddPeriod(scope)\"\r\n            size=\"mini\"\r\n            type=\"primary\"\r\n            icon=\"el-icon-edit\"\r\n          >\r\n            录入时长\r\n          </el-button>\r\n          <el-button @click=\"handleDelete(scope)\" size=\"mini\" type=\"danger\">\r\n            删除\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <!-- 分页 -->\r\n    <div class=\"common_pagination_wrapper\">\r\n      <el-pagination\r\n        :current-page.sync=\"pagination.page\"\r\n        :page-size=\"pagination.limit\"\r\n        :page-sizes=\"[10, 20, 30, 50, 100]\"\r\n        :total=\"pagination.total\"\r\n        @current-change=\"handleCurrentChange\"\r\n        @size-change=\"handleSizeChange\"\r\n        background\r\n        layout=\"total, sizes, prev, pager, next, jumper\"\r\n      >\r\n      </el-pagination>\r\n    </div>\r\n    <!-- 编辑 -->\r\n    <!-- 123 -->\r\n    <el-dialog\r\n      :title=\"textMap[dialogStatus]\"\r\n      :visible.sync=\"dialogFormVisible\"\r\n      top=\"5vh\"\r\n      @close=\"handleCloseFansInfoDialog\"\r\n    >\r\n      <el-row type=\"flex\" justify=\"left\">\r\n        <el-col :span=\"12\">\r\n          <el-form\r\n            ref=\"formData\"\r\n            :model=\"formData\"\r\n            :rules=\"rules\"\r\n            label-position=\"right\"\r\n            label-width=\"80px\"\r\n            class=\"dialog_wrapper\"\r\n          >\r\n            <el-form-item label=\"粉丝昵称\" prop=\"nickName\">\r\n              <el-input v-model=\"formData.nickName\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"E-mail\" prop=\"email\">\r\n              <el-input v-model=\"formData.email\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"电话\" prop=\"phone\">\r\n              <el-input v-model=\"formData.phone\"></el-input>\r\n            </el-form-item>\r\n          </el-form>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <whiteSpace size=\"xl\" />\r\n      <div class=\"footer alignright\">\r\n        <el-button\r\n          type=\"primary\"\r\n          :disabled=\"submitingFlag\"\r\n          @click=\"handleSaveFan\"\r\n        >\r\n          保存\r\n        </el-button>\r\n        <el-button @click=\"handleCloseFansInfoDialog\">取消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!-- 时长录入 -->\r\n    <!-- 456 -->\r\n    <el-dialog\r\n      title=\"时长录入\"\r\n      :visible.sync=\"dialogrRecordPaymentVisible\"\r\n      @close=\"handleCloseRecordPeriod\"\r\n      top=\"5vh\"\r\n      width=\"1200px\"\r\n      :close-on-click-modal=\"false\"\r\n    >\r\n      <el-form\r\n        ref=\"formData2\"\r\n        :model=\"formData2\"\r\n        :rules=\"rules2\"\r\n        label-position=\"top\"\r\n        label-width=\"80px\"\r\n      >\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-row>\r\n              <el-col :span=\"24\">\r\n                <el-form-item label=\"起始日期\" prop=\"startDate\">\r\n                  <el-date-picker\r\n                    v-model=\"formData2.startDate\"\r\n                    type=\"date\"\r\n                    @change=\"handleChangeStartDate\"\r\n                    :picker-options=\"pickerOptions\"\r\n                    :default-value=\"defaultTime\"\r\n                    :editable=\"false\"\r\n                  >\r\n                  </el-date-picker>\r\n                </el-form-item>\r\n              </el-col>\r\n              <el-col :span=\"24\">\r\n                <el-form-item label=\"时长\" prop=\"period\">\r\n                  <el-select\r\n                    v-model=\"formData2.period\"\r\n                    @change=\"calculateDuration\"\r\n                  >\r\n                    <el-option\r\n                      v-for=\"(item, index) in periodDictionary\"\r\n                      :key=\"index\"\r\n                      :label=\"item.title\"\r\n                      :value=\"item.value\"\r\n                      :disabled=\"item.disabled\"\r\n                    ></el-option>\r\n                  </el-select>\r\n                </el-form-item>\r\n              </el-col>\r\n            </el-row>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-row>\r\n              <el-col :span=\"24\">\r\n                <ul class=\"duration\">\r\n                  <li>粉丝昵称：{{ formData.nickName }}</li>\r\n                  <li>\r\n                    权益状态:\r\n                    <el-tag v-if=\"expireStatus === 'new_fan'\" type=\"info\">\r\n                      新粉丝\r\n                    </el-tag>\r\n                    <el-tag\r\n                      v-else-if=\"expireStatus === 'not_started'\"\r\n                      type=\"info\"\r\n                    >\r\n                      未开始\r\n                    </el-tag>\r\n                    <el-tag\r\n                      v-else-if=\"expireStatus === 'in_progress'\"\r\n                      type=\"success\"\r\n                    >\r\n                      进行中\r\n                    </el-tag>\r\n                    <el-tag v-if=\"expireStatus === 'expired'\" type=\"danger\">\r\n                      已到期\r\n                    </el-tag>\r\n                  </li>\r\n                  <li>\r\n                    当前权益有效期至:\r\n                    {{\r\n                      $isNotEmpty(lastExpireDateString)\r\n                        ? $moment(lastExpireDateString).format('YYYY-MM-DD')\r\n                        : '-'\r\n                    }}\r\n                  </li>\r\n                  <li>\r\n                    添加后有效期至:\r\n                    {{\r\n                      $isNotEmpty(formData2.expireDate)\r\n                        ? $moment(formData2.expireDate).format('YYYY-MM-DD')\r\n                        : '-'\r\n                    }}\r\n                  </li>\r\n                </ul>\r\n              </el-col>\r\n            </el-row>\r\n          </el-col>\r\n        </el-row>\r\n        <el-button\r\n          type=\"primary\"\r\n          :disabled=\"submitingFlag\"\r\n          @click=\"submitAddPeriod\"\r\n        >\r\n          保存\r\n        </el-button>\r\n        <whiteSpace size=\"xl\" />\r\n        <el-form-item label=\"权益记录\">\r\n          <el-table\r\n            class=\"common_table_wrapper\"\r\n            :data=\"periodHistoryTableData\"\r\n            border\r\n            element-loading-text=\"Loading\"\r\n            fit\r\n            highlight-current-row\r\n            v-loading.body=\"listLoading\"\r\n          >\r\n            <el-table-column\r\n              align=\"center\"\r\n              fixed\r\n              label=\"No\"\r\n              type=\"index\"\r\n              width=\"45\"\r\n            ></el-table-column>\r\n            <el-table-column\r\n              align=\"center\"\r\n              fixed\r\n              label=\"周期\"\r\n              prop=\"period\"\r\n            ></el-table-column>\r\n            <el-table-column\r\n              align=\"center\"\r\n              fixed\r\n              label=\"开始时间\"\r\n              prop=\"createdAt\"\r\n            >\r\n              <template slot-scope=\"scope\">\r\n                {{\r\n                  $moment(\r\n                    getTheDayBeforeOffsetTimestamp({\r\n                      dateString: scope.row.expireDate,\r\n                      offsetDays: scope.row.period\r\n                    }) * 1000\r\n                  ).format('YYYY-MM-DD')\r\n                }}\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              align=\"center\"\r\n              fixed\r\n              label=\"结束时间\"\r\n              prop=\"createdAt\"\r\n            >\r\n              <template slot-scope=\"scope\">\r\n                {{ $moment(scope.row.expireDate).format('YYYY-MM-DD') }}\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              align=\"center\"\r\n              fixed\r\n              label=\"进行状态\"\r\n              prop=\"createdAt\"\r\n            >\r\n              <template slot-scope=\"scope\">\r\n                {{ checkProgressStatus(scope) }}\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              align=\"center\"\r\n              fixed\r\n              label=\"录入时间\"\r\n              width=\"200\"\r\n              prop=\"createdAt\"\r\n            >\r\n              <template slot-scope=\"scope\">\r\n                {{ $moment(scope.row.createdAt).format('YYYY-MM-DD hh:mm:ss') }}\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column align=\"center\" fixed label=\"操作\">\r\n              <template slot-scope=\"scope\">\r\n                <el-button\r\n                  v-if=\"checkIsNotStartedRecord(scope)\"\r\n                  type=\"danger\"\r\n                  size=\"mini\"\r\n                  icon=\"el-icon-delete\"\r\n                  @click=\"handleDeletePeriod(scope)\"\r\n                >\r\n                  删除此权益\r\n                </el-button>\r\n                <el-button\r\n                  v-if=\"checkIsExpiredRecord(scope)\"\r\n                  size=\"mini\"\r\n                  icon=\"el-icon-delete\"\r\n                  @click=\"handleDeletePeriod(scope)\"\r\n                >\r\n                  删除此记录\r\n                </el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n          <whiteSpace size=\"xl\" />\r\n          <el-pagination\r\n            :current-page.sync=\"pagination2.page\"\r\n            :page-size=\"pagination2.limit\"\r\n            :total=\"pagination2.total\"\r\n            @current-change=\"getPeriodHistoryTableData\"\r\n            @size-change=\"handleSizeChange2\"\r\n            background\r\n            layout=\"total, prev, pager, next, jumper\"\r\n          >\r\n          </el-pagination>\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n      <div class=\"footer alignright\">\r\n        <el-button @click=\"handleCloseRecordPeriod\">关闭</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </el-row>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      getListByPaginationRequest: 'fans/getListByPagination',\r\n      createOrUpdateRequest: 'fans/createOrUpdate',\r\n      deleteItemsRequest: 'fans/deleteItems',\r\n      addPeriodRequest: 'fans/addPeriod',\r\n      getFansInfoRequest: 'fans/getFansInfo',\r\n      getPeriodHistoryRequest: 'fans/getPeriodHistory',\r\n      deletePeriodRequest: 'fans/deletePeriod',\r\n      periodDictionary: [\r\n        {\r\n          title: '90天',\r\n          name: '90days',\r\n          value: 90\r\n        },\r\n        {\r\n          title: '180天',\r\n          name: '180days',\r\n          value: 180\r\n        },\r\n        {\r\n          title: '365天',\r\n          name: '365days',\r\n          value: 365\r\n        }\r\n      ],\r\n      dialogFormVisible: false,\r\n      dialogrRecordPaymentVisible: false,\r\n      tableList: [],\r\n      total: null,\r\n      listLoading: true,\r\n      availabilityFlag: false,\r\n      queryModel: {\r\n        sort: 'desc',\r\n        brandName: ''\r\n      },\r\n      pagination: {\r\n        page: 1,\r\n        limit: 30\r\n      },\r\n      sortOptions: [\r\n        { label: 'ID Ascending', key: '+id' },\r\n        { label: 'ID Descending', key: '-id' }\r\n      ],\r\n      statusOptions: ['published', 'draft', 'deleted'],\r\n      showReviewer: false,\r\n      currentVotingFormdata: [],\r\n      dialogFormVisible: false,\r\n      dialogStatus: '',\r\n      textMap: {\r\n        update: 'Edit',\r\n        create: 'Create'\r\n      },\r\n      dialogPvVisible: false,\r\n      submitingFlag: false,\r\n      formData: {\r\n        nickName: '',\r\n        email: '',\r\n        phone: ''\r\n      },\r\n      rules: {\r\n        nickName: [\r\n          { required: true, message: '此项为必填项', trigger: 'change' }\r\n        ],\r\n        email: [\r\n          { required: false, message: '此项为必填项', trigger: 'change' }\r\n        ],\r\n        phone: [{ required: false, message: '此项为必填项', trigger: 'change' }]\r\n      },\r\n      formData2: {\r\n        startDate: '',\r\n        period: '',\r\n        expireDate: ''\r\n      },\r\n      rules2: {\r\n        startDate: [\r\n          { required: true, message: '此项为必填项', trigger: 'change' }\r\n        ],\r\n        period: [{ required: true, message: '此项为必填项', trigger: 'change' }]\r\n      },\r\n      pagination2: {\r\n        limit: 5,\r\n        page: 1,\r\n        total: 0\r\n      },\r\n      periodHistoryData: [],\r\n      periodHistoryTableData: [],\r\n      currentPickerData: null,\r\n      storedExpireDate: null,\r\n      defaultTime: null,\r\n      lastExpireDateString: null,\r\n      expireStatus: null\r\n    };\r\n  },\r\n  computed: {\r\n    tableHeight() {\r\n      return this.$store.state.app.tableHeight;\r\n    },\r\n    dictionaryList() {\r\n      return this.$store.state.app.dictionary.crawlerAddress;\r\n    },\r\n    dialogHeight() {\r\n      return {\r\n        height: '60vh'\r\n      };\r\n    },\r\n    period() {\r\n      return this.formData2.startDate;\r\n    },\r\n    pickerOptions() {\r\n      const that = this;\r\n      return {\r\n        shortcuts: [\r\n          {\r\n            text: '今天',\r\n            onClick(picker) {\r\n              picker.$emit('pick', new Date());\r\n            }\r\n          },\r\n          {\r\n            text: '到期日后一天',\r\n            onClick(picker) {\r\n              // 先从最近到期日转成秒级时间戳，然后加一天，然后转成毫秒级，然后用new Date()转换成时间对象\r\n              if (that.$isNotEmpty(that.lastExpireDateString)) {\r\n                const theDayAfterLastExpireDayTimestamp =\r\n                  that.$moment(that.lastExpireDateString).unix() + 24 * 3600;\r\n                picker.$emit(\r\n                  'pick',\r\n                  new Date(theDayAfterLastExpireDayTimestamp * 1000)\r\n                );\r\n              }\r\n            }\r\n          }\r\n        ],\r\n        disabledDate: time => {\r\n          const currentTimestamp = time.getTime() / 1000;\r\n          return this.checkDateAvailable(currentTimestamp);\r\n        }\r\n      };\r\n    }\r\n  },\r\n  watch: {\r\n    effectiveDuration(value) {\r\n      console.log(value);\r\n      if (value === null) {\r\n        value = [];\r\n      }\r\n      this.formData.startDate = this.$moment(value[0]).format('YYYY-MM-DD');\r\n      this.formData.endDate = this.$moment(value[1]).format('YYYY-MM-DD');\r\n    },\r\n    currentAdvertisementTabIndex(value) {\r\n      console.log(value);\r\n    }\r\n    // 'formData2.startDate': {\r\n    //   handler(value) {\r\n    //     this.periodDictionary = this.periodDictionary.map(item => {\r\n    //       return {\r\n    //         ...item,\r\n    //         disabled: this.$isEmpty(value)\r\n    //       };\r\n    //     });\r\n    //   },\r\n    // }\r\n  },\r\n  async mounted() {\r\n    this.getTableData();\r\n  },\r\n  methods: {\r\n    getTableData() {\r\n      this.listLoading = true;\r\n      this.queryModel = Object.assign(this.queryModel, this.pagination);\r\n      this.$http\r\n        .get(this.getListByPaginationRequest, {\r\n          params: this.queryModel\r\n        })\r\n        .then(response => {\r\n          console.log('getListByPaginationRequest', response);\r\n          this.tableList = response.data;\r\n          this.pagination.total = response.pagination.total;\r\n          this.listLoading = false;\r\n        })\r\n        .catch(error => {\r\n          console.log(error);\r\n        });\r\n    },\r\n    checkDateAvailable(timestamp) {\r\n      let result = false;\r\n      this.periodHistoryTableData.forEach(item => {\r\n        const periodTimestamp = item.period * 24 * 3600;\r\n        const endDateTimestamp = this.$moment(item.expireDate).unix();\r\n        const startDateTimestamp = endDateTimestamp - periodTimestamp;\r\n        if (\r\n          startDateTimestamp < timestamp + 24 * 3600 &&\r\n          endDateTimestamp > timestamp\r\n        ) {\r\n          result = true;\r\n        }\r\n      });\r\n      return result;\r\n    },\r\n    handleFilter() {\r\n      this.pagination.page = 1;\r\n      this.getTableData();\r\n    },\r\n    handleSizeChange(val) {\r\n      this.pagination.limit = val;\r\n      this.getTableData();\r\n    },\r\n    handleCurrentChange(val) {\r\n      this.pagination.page = val;\r\n      this.getTableData();\r\n    },\r\n    handleSizeChange2(val) {\r\n      this.pagination2.limit = val;\r\n      this.getPeriodHistory();\r\n    },\r\n    handleCurrentChange2(val) {\r\n      this.pagination2.page = val;\r\n      this.getPeriodHistory();\r\n    },\r\n\r\n    createData() {\r\n      this.formData.id = '';\r\n      this.updateData();\r\n    },\r\n    handleSaveFan() {\r\n      this.$refs.formData\r\n        .validate()\r\n        .then(valid => {\r\n          this.submitingFlag = true;\r\n          console.log(this.formData);\r\n          this.$http\r\n            .post(this.createOrUpdateRequest, this.formData)\r\n            .then(response => {\r\n              console.log(response);\r\n              this.submitingFlag = false;\r\n              this.$message.success('提交成功');\r\n              this.dialogFormVisible = false;\r\n              this.getTableData();\r\n            })\r\n            .catch(error => {\r\n              console.log(error);\r\n              this.submitingFlag = false;\r\n            });\r\n        })\r\n        .catch(error => {\r\n          console.log(error);\r\n        });\r\n    },\r\n\r\n    async handleUpdateFanInfo(scope) {\r\n      this.dialogFormVisible = true;\r\n      await this.$nextTick();\r\n      console.log(scope);\r\n      this.formData = {\r\n        id: scope.row.id,\r\n        email: scope.row.email,\r\n        phone: scope.row.phone,\r\n        nickName: scope.row.nickName\r\n      };\r\n      console.log(this.formData);\r\n\r\n      this.dialogStatus = 'update';\r\n      this.$refs.formData.clearValidate();\r\n    },\r\n    async handleAddPeriod(scope) {\r\n      await this.$nextTick();\r\n      this.dialogrRecordPaymentVisible = true;\r\n      this.storedExpireDate = scope.row.expireDate;\r\n      this.formData.nickName = scope.row.nickName;\r\n      this.formData2.id = scope.row.id;\r\n\r\n      this.getTableData();\r\n      await this.getPeriodHistory();\r\n      this.defaultTime = this.getDefaultTime();\r\n    },\r\n    submitAddPeriod() {\r\n      this.$refs.formData2.validate().then(valid => {\r\n        this.$http\r\n          .post(this.addPeriodRequest, this.formData2)\r\n          .then(async response => {\r\n            console.log(response);\r\n            this.$message.success('提交成功');\r\n            await this.getPeriodHistory();\r\n          })\r\n          .catch(error => {\r\n            console.log(error);\r\n          });\r\n      });\r\n    },\r\n    getFansInfo(scope) {\r\n      return new Promise((resolve, reject) => {\r\n        this.$http\r\n          .get(this.getFansInfoRequest, {\r\n            params: {\r\n              id: scope.row.id\r\n            }\r\n          })\r\n          .then(response => {\r\n            console.log('getFansInfo++++++', response);\r\n            this.formData = response.result;\r\n            resolve();\r\n          })\r\n          .catch(error => {\r\n            console.log(error);\r\n            reject(error);\r\n          });\r\n      });\r\n    },\r\n    getPeriodHistory() {\r\n      return new Promise((resolve, reject) => {\r\n        this.$http\r\n          .get(this.getPeriodHistoryRequest, {\r\n            params: {\r\n              limit: this.pagination2.limit,\r\n              page: this.pagination2.page,\r\n              fanId: this.formData2.id\r\n            }\r\n          })\r\n          .then(response => {\r\n            console.log('getPeriodHistory++++', response);\r\n            this.periodHistoryData = response.data;\r\n            this.getPeriodHistoryTableData(1);\r\n            this.defaultTime = this.getDefaultTime();\r\n            this.pagination2.total = response.total;\r\n            this.getLastExpireDateString();\r\n            resolve();\r\n          })\r\n          .catch(error => {\r\n            console.log(error);\r\n            reject();\r\n          });\r\n      });\r\n    },\r\n    getPeriodHistoryTableData(page) {\r\n      page = page || this.pagination2.page;\r\n      const offset = this.pagination2.limit;\r\n      page = page - 1;\r\n      this.periodHistoryTableData = this.periodHistoryData.filter(\r\n        (item, index) => index >= page * offset && index < (page + 1) * offset\r\n      );\r\n    },\r\n    getLastExpireDateString() {\r\n      this.lastExpireDateString = this.periodHistoryData[0]\r\n        ? this.periodHistoryData[0].expireDate\r\n        : '';\r\n      this.expireStatus = this.checkSchedule();\r\n    },\r\n    handleSelectionChange(val) {\r\n      this.multipleSelection = val;\r\n      console.log(val);\r\n    },\r\n    handleMultipleDelete() {\r\n      this.$confirm('确认删除?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      })\r\n        .then(() => {\r\n          console.log('this.multipleSelection+++++', this.multipleSelection);\r\n          this.deleteRecord(\r\n            this.multipleSelection.map(item => {\r\n              return {\r\n                id: item.id\r\n              };\r\n            })\r\n          );\r\n        })\r\n        .catch(() => {\r\n          this.$message({\r\n            type: 'info',\r\n            message: '已取消删除'\r\n          });\r\n        });\r\n    },\r\n    handleDelete(scope) {\r\n      console.log(scope);\r\n      this.$confirm('确认删除?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      })\r\n        .then(() => {\r\n          this.deleteRecord({\r\n            id: scope.row.id\r\n          });\r\n        })\r\n        .catch(() => {\r\n          this.$message({\r\n            type: 'info',\r\n            message: '已取消删除'\r\n          });\r\n        });\r\n    },\r\n    deleteRecord(params) {\r\n      this.$http\r\n        .delete(this.deleteItemsRequest, {\r\n          data: params\r\n        })\r\n        .then(response => {\r\n          console.log(response);\r\n          this.$message.success('删除成功');\r\n          this.getTableData();\r\n        })\r\n        .catch(error => {\r\n          console.log(error);\r\n        });\r\n    },\r\n\r\n    expand() {\r\n      this.expandQuery = !this.expandQuery;\r\n    },\r\n    search() {\r\n      this.getTableData();\r\n    },\r\n    reset() {\r\n      this.queryModel.available = true;\r\n    },\r\n\r\n    focusSortList(queryString, callback) {\r\n      this.loading = true;\r\n\r\n      this.$http\r\n        .get(this.queryRewardProductByNameRequest, {\r\n          params: {\r\n            name: this.chosenReward\r\n          }\r\n        })\r\n        .then(response => {\r\n          console.log(response);\r\n          this.loading = false;\r\n          // this.total = response.total;\r\n          let result = [];\r\n          if (response.data.length !== 0) {\r\n            response.data.forEach((item, index) => {\r\n              result.push(\r\n                Object.assign(item, {\r\n                  value: item.name\r\n                })\r\n              );\r\n            });\r\n\r\n            console.log(111, result);\r\n\r\n            callback(result);\r\n          }\r\n        });\r\n    },\r\n\r\n    handleCreateFan() {\r\n      this.dialogFormVisible = true;\r\n      this.dialogStatus = 'create';\r\n    },\r\n    handleAddOption() {\r\n      this.formData.optionList.push({\r\n        votingId: this.formData.id,\r\n        title: '',\r\n        description: ''\r\n      });\r\n    },\r\n    handleDeleteOption(item, index) {\r\n      this.formData.optionList.splice(index, 1);\r\n    },\r\n\r\n    handleChangeStartDate(dateObj) {\r\n      this.storedExpireDate = dateObj;\r\n      this.formData2.period = '';\r\n      this.calculateDuration();\r\n      this.filterPeriodDictionary();\r\n    },\r\n    filterPeriodDictionary() {\r\n      this.periodDictionary = this.periodDictionary.map(item => {\r\n        return {\r\n          ...item,\r\n          disabled: this.$isEmpty(this.formData2.startDate)\r\n            ? true\r\n            : !this.checkAvailableDuration(item.value)\r\n        };\r\n      });\r\n    },\r\n    calculateDuration() {\r\n      if (!this.storedExpireDate || !this.formData2.period) return;\r\n      this.formData2.expireDate = this.$moment(this.storedExpireDate)\r\n        .add(this.formData2.period, 'days')\r\n        .format('YYYY-MM-DD');\r\n    },\r\n    checkAvailableDuration(period) {\r\n      let result = false;\r\n\r\n      const allStartDateTimestampList = this.periodHistoryData\r\n        .sort((item1, item2) => {\r\n          const expireDateTimestamp1 = this.$moment(item1.expireDate).unix();\r\n          const expireDateTimestamp2 = this.$moment(item2.expireDate).unix();\r\n          if (expireDateTimestamp1 < expireDateTimestamp2) {\r\n            return -1;\r\n          }\r\n          if (expireDateTimestamp1 > expireDateTimestamp2) {\r\n            return 1;\r\n          }\r\n          return 0;\r\n        })\r\n        .map(item => {\r\n          return {\r\n            startDateTimestamp:\r\n              this.$moment(item.expireDate).unix() - item.period * 24 * 3600,\r\n            endDateTimestamp: this.$moment(item.expireDate).unix()\r\n          };\r\n        });\r\n\r\n      if (this.periodHistoryData.length === 0) {\r\n        result = this.periodHistoryData.length === 0;\r\n      } else {\r\n        for (let index = 0; index < allStartDateTimestampList.length; index++) {\r\n          const item = allStartDateTimestampList[index];\r\n          let chosenPeriod = period || this.formData2.period;\r\n          chosenPeriod = this.$isNotEmpty(chosenPeriod)\r\n            ? chosenPeriod\r\n            : this.periodDictionary[0].value;\r\n          const chosenPeriodTimestamp = chosenPeriod * 24 * 3600;\r\n          const chosenStartDateTimestamp = this.$moment(\r\n            this.storedExpireDate\r\n          ).unix();\r\n          const chosenEndDateTimestamp =\r\n            chosenStartDateTimestamp + chosenPeriodTimestamp;\r\n          const previousEndDateTimestamp =\r\n            index > 0\r\n              ? allStartDateTimestampList[index - 1].endDateTimestamp\r\n              : null;\r\n          const firstStartDateTimestamp =\r\n            allStartDateTimestampList[0].startDateTimestamp;\r\n          const lastEndDateTimestamp =\r\n            allStartDateTimestampList[allStartDateTimestampList.length - 1]\r\n              .endDateTimestamp;\r\n\r\n          if (\r\n            chosenStartDateTimestamp < firstStartDateTimestamp &&\r\n            chosenEndDateTimestamp < firstStartDateTimestamp\r\n          ) {\r\n            result = true;\r\n            break;\r\n          } else if (\r\n            chosenStartDateTimestamp > firstStartDateTimestamp &&\r\n            chosenStartDateTimestamp < lastEndDateTimestamp &&\r\n            chosenStartDateTimestamp > previousEndDateTimestamp &&\r\n            chosenEndDateTimestamp < item.startDateTimestamp\r\n          ) {\r\n            result = true;\r\n            break;\r\n          } else if (chosenStartDateTimestamp > lastEndDateTimestamp) {\r\n            result = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      return result;\r\n    },\r\n    getTheDayAfterOffsetTimestamp(options) {\r\n      const offsetDaysTimestamp = options.offsetDays * 24 * 3600;\r\n      return this.$moment(options.dateString).unix() + offsetDaysTimestamp;\r\n    },\r\n    getTheDayBeforeOffsetTimestamp(options) {\r\n      const offsetDaysTimestamp = options.offsetDays * 24 * 3600;\r\n      return this.$moment(options.dateString).unix() - offsetDaysTimestamp;\r\n    },\r\n    checkSchedule() {\r\n      let result = '';\r\n      const lastExpireDateTimestamp = this.getTheDayAfterOffsetTimestamp({\r\n        dateString: this.lastExpireDateString,\r\n        offsetDays: this.formData2.period\r\n      });\r\n      const currentDateTimestamp = this.$moment().unix();\r\n\r\n      if (this.periodHistoryData.length === 0) {\r\n        result = 'new_fan';\r\n      } else if (lastExpireDateTimestamp - currentDateTimestamp < 0) {\r\n        result = 'expired';\r\n      } else if (this.checkIfOnProgress()) {\r\n        result = 'in_progress';\r\n      } else if (!this.checkIfOnProgress()) {\r\n        result = 'not_started';\r\n      }\r\n      return result;\r\n    },\r\n    checkIfOnProgress() {\r\n      let result = false;\r\n      this.periodHistoryData.forEach(item => {\r\n        const startDateTimestamp = this.getTheDayBeforeOffsetTimestamp({\r\n          dateString: item.expireDate,\r\n          offsetDays: item.period\r\n        });\r\n        const endDateTimestamp = this.$moment(item.expireDate).unix();\r\n        const currentDateTimestamp = this.$moment().unix();\r\n        // console.log('startDateTimestamp', startDateTimestamp);\r\n        // console.log('endDateTimestamp', endDateTimestamp);\r\n        if (\r\n          currentDateTimestamp <= endDateTimestamp &&\r\n          currentDateTimestamp >= startDateTimestamp\r\n        ) {\r\n          result = true;\r\n        }\r\n      });\r\n      return result;\r\n    },\r\n    getDefaultTime() {\r\n      const currentDate = this.$moment();\r\n      return this.checkSchedule() === 'not_expired'\r\n        ? this.$moment(this.lastExpireDateString)\r\n        : currentDate;\r\n    },\r\n    async handleCloseRecordPeriod() {\r\n      this.$refs.formData2.resetFields();\r\n      this.formData2.expireDate = null;\r\n      this.periodHistoryData = [];\r\n      this.pagination2.page = 1;\r\n      this.dialogrRecordPaymentVisible = false;\r\n    },\r\n    async handleCloseFansInfoDialog() {\r\n      this.$refs.formData.resetFields();\r\n\r\n      this.dialogFormVisible = false;\r\n    },\r\n    handleDeletePeriod(scope) {\r\n      this.$alert('确认删除此条权益?', '警告', {\r\n        type: 'warning',\r\n        callback: async action => {\r\n          this.deletePeriod(action, scope);\r\n        }\r\n      });\r\n    },\r\n    deletePeriod(action, scope) {\r\n      this.$http\r\n        .delete(this.deletePeriodRequest, {\r\n          data: {\r\n            id: scope.row.id\r\n          }\r\n        })\r\n        .then(async response => {\r\n          this.$message({\r\n            type: 'success',\r\n            message: '权益删除成功'\r\n          });\r\n          await this.getPeriodHistory();\r\n        })\r\n        .catch(error => {\r\n          console.log(error);\r\n        });\r\n    },\r\n    checkIsNotStartedRecord(scope) {\r\n      const todayTimestamp = this.$moment().unix();\r\n      const theDayBeforeOffsetTimestamp = this.getTheDayBeforeOffsetTimestamp({\r\n        dateString: scope.row.expireDate,\r\n        offsetDays: scope.row.period\r\n      });\r\n      return theDayBeforeOffsetTimestamp >= todayTimestamp;\r\n    },\r\n\r\n    checkIsExpiredRecord(scope) {\r\n      const todayTimestamp = this.$moment().unix();\r\n      const expireDateTimestamp = this.$moment(scope.row.expireDate).unix();\r\n      return expireDateTimestamp < todayTimestamp;\r\n    },\r\n    checkProgressStatus(scope) {\r\n      if (this.checkIsNotStartedRecord(scope)) {\r\n        return '未开始';\r\n      } else if (this.checkIsExpiredRecord(scope)) {\r\n        return '已结束';\r\n      } else {\r\n        return '进行中';\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.duration {\r\n  li {\r\n    margin: 0 0 25px 0;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FansManagement.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FansManagement.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FansManagement.vue?vue&type=template&id=11611500&scoped=true&\"\nimport script from \"./FansManagement.vue?vue&type=script&lang=js&\"\nexport * from \"./FansManagement.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FansManagement.vue?vue&type=style&index=0&id=11611500&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"11611500\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}